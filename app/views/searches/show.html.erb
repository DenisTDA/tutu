<h1> Поиск билета </h1>
<%= form_tag search_path, method: :post do %>

 <table>
    <thead>
      <tr>
        <td> <%= label :start_station, 'Начальная станция' %> </td>
        <td width =  "50px">
        <td>  <%= label :end_station, 'Конечная станция' %> </td>
      </tr>
    </thead>
    <tbody>
      <tr>
      <td><%= collection_select :stations, :start_station_id, RailwayStation.all, :id, :title %> </td>
      <td width =  "50px">
      <td> <%= collection_select :stations, :end_station_id, RailwayStation.all, :id, :title %> </td>
      </tr>
    </tbody>
  </table>

   <div class="actions">
    <%= submit_tag 'Поиск' %>
  </div>
<% end %>

<% if @trains.present? %>
  <p>Результаты поиска</p>
  <table>
    <thead>
      <tr>
        <td>Поезд</td>
        <td width =  "200px">Маршрут</td>
        <td width =  "100px">Отправление</td>
        <td>Время</td>
        <td width =  "100px">Прибытие</td>
        <td>Время</td>
        <td></td>
      </tr>
    </thead>
    <tbody>
      <% @trains.each do |train| %>
        <tr>
          <td><%= train.number %></td>
          <td width =  "200px"><%= train.route.name %></td>
          <td width =  "100px"><%= @start_station.title %></td>
          <td> <%= @start_station.time_event(train.route, :departure_time) %></td>
          <td width =  "100px"><%= @end_station.title %></td>
          <td> <%= @start_station.time_event(train.route, :arrive_time) %></td>

          <% if current_user.admin? %>
            <td><%= link_to 'Оформить билет', new_admin_ticket_path(train_id: train.id, start_station_id: @start_station, end_station_id: @end_station) %></td>
          <% else %>
            <td><%= link_to 'Купить билет', new_ticket_path(train_id: train.id, start_station_id: @start_station, end_station_id: @end_station) %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>